if($('.js_shop_id').length){var $fotoramaDiv=$('#fotorama').fotorama(),fotorama=$fotoramaDiv.data('fotorama');setTimeout(function(){fotorama.resize()},10)}
$(document).on('change',".js_shop_depend_param, .shop_form .depend_param",function(){var image_id=$(this).parents('.js_shop').find('.js_shop_param_price:visible').attr('image_id'),js_shop_id=$(this).parents('.js_shop').data('id');if($(this).parents('.js_shop').length&&$(this).parents('.js_shop').find('.owl-carousel').length){owl_index_id=$(this).parents('.js_shop').find('.js_shop_img[image_id="'+image_id+'"]').data('owl-index-id');owl_array[js_shop_id].trigger('to.owl.carousel',[owl_index_id-1,200])}else if($(this).parents('.js_shop_id').length){fotorama_index=$('.js_shop_id_img[image_id="'+image_id+'"]').data('fotorama-index-id');fotorama.show(fotorama_index-1)}});$(document).on('click','.shop-like',function(){var modal_object=modal_create($(this));setTimeout(function(){modal_open(!1,modal_object)},20);if($(this).hasClass("active")){$(this).removeClass("active");modal_nottification_success(modal_object,'Товар успешно удален из избранного',!1);$(document).tooltip('destroy');$(this).attr('title','Добавить товар в список избранного')}else{$(this).addClass("active");modal_nottification_success(modal_object,'Товар успешно добавлен в избранное',!1);$(document).tooltip('destroy');$(this).attr('title','Удалить товар из списка избранного')}
$(document).tooltip(tooltip_object)});diafan_ajax.success.shop_compare_goods=function(form,response){var modal_object=modal_create(form);setTimeout(function(){modal_open(!1,modal_object)},20);if(form.find('.shop_add_compare').hasClass("active")){form.find('.shop_add_compare').removeClass("active");modal_nottification_success(modal_object,'Товар успешно удален из списка сравнения',!1);$(document).tooltip('destroy');form.attr('title','Добавить товар в список сравнения')}else{form.find('.shop_add_compare').addClass("active");modal_nottification_success(modal_object,'Товар успешно добавлен в список сравнения',!1);$(document).tooltip('destroy');form.attr('title','Удалить товар из списка сравнения')}
$(document).tooltip(tooltip_object);if(!$('.header-compare-count').length)return;var count=$('.header-compare-count').html();if(form.find('.js_shop_add_compare').is(':checked')){count++}else{count--}
$('.header-compare-count').html(count);if(!count){$('.header-compare-count').hide();$('.header-compare-icon').removeClass('active')}else{$('.header-compare-count').show();$('.header-compare-icon').addClass('active')}}
$(document).on('click','.js_waitlist_button',function(){var self_form=$(this).parents('form');self_form.find('input[name=action]').val('wait');server_action_wait($(this),'shop_wait')});$(document).on('click','.js-waitlist-preload',function(){$(this).parents('.js_shop_waitlist').find('.js-waitlist-preload-load').show();$(this).hide()});diafan_ajax.success.shop_wait=function(form,response){var modal_object=modal_create($('.js-waitlist-preload-load',form));setTimeout(function(){modal_open(!1,modal_object)},20);if(response.errors.success==!0){$('input[type="email"]',form).val('');$('.js-waitlist-preload-load input, .js-waitlist-preload-load button',form).attr('disabled','disabled');$('.js-waitlist-preload-load',form).addClass('disabled');modal_nottification_success(modal_object,response.errors.waitlist,!0)}else{modal_nottification_error(modal_object,response.errors.waitlist,!0)}
server_action_wait_return('shop_wait')}
$(document).on('click','input[action=one_click]',function(){modal_open(!1,$(this).parents('.js_shop, .js_shop_id').find('.js_cart_one_click.modal'))});$(document).on('click','.shop-buy-form-to-cart-btn',function(){$(this).parents('form').find('input[name=action]').val('buy');$(this).parents('form').submit()});diafan_ajax.before.shop_buy=function(form){var action=$('.shop-buy-form-to-cart-btn:not(.no-animation)',form);server_action_wait(action,'shop_buy')}
diafan_ajax.before.cart_one_click=function(form){var action=$('.js-cart-order-one-click',form),self=action.parents(".js_cart_one_click_form, .cart_one_click_form");server_action_wait(action,'cart_one_click');$('.js_shop_form_param input, .js_shop_form_param select, .shop_form_param input, .shop_form_param select, input[name=count], .js_shop_additional_cost input[type="checkbox"]:checked','form[one_click=true]').each(function(){$("input[name='"+$(this).attr('name')+"']",self).remove();self.prepend('<input type="hidden" name="'+$(this).attr('name')+'" value="'+$(this).val()+'">')});$("input[name='additional_cost[]']",self).remove();$('.js_shop_additional_cost input[type="checkbox"]:checked','form[one_click=true]').each(function(){self.prepend('<input type="hidden" name="'+$(this).attr('name')+'" value="'+$(this).val()+'">')})}
diafan_ajax.success.cart_one_click=function(form,response){if(response.errors!=undefined){server_action_wait_return('cart_one_click')}else{eval(response.ecommerce);setTimeout(()=>{document.location.href=response.redirect_after},2000)}}
diafan_ajax.success.shop_buy=function(form,response){var modal_object=modal_create($('.shop-buy-form-to-cart-btn',form)),errors=response.errors[0];setTimeout(function(){modal_open(!1,modal_object,!0)},200);var text=$(form).find('.modal-text_before').html();text+='<p>'+errors.replace(/&lt;/g,'<').replace(/&gt;/g,'>')+'</p>';text+=$(form).find('.modal-text_after').html();if(errors.indexOf('Извините')+1||errors.indexOf('Товара с заданными параметрами не существует')+1||errors.indexOf('Пожалуйста, выберите')+1){modal_nottification_error(modal_object,errors.replace(/&lt;/g,'<').replace(/&gt;/g,'>'),!0)}else{modal_nottification_success(modal_object,text,!1)}
server_action_wait_return('shop_buy')}